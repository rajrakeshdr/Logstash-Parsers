##
input 
{
#udp {
#	type => "syslog"
#	port => 6000
#}
#stdin{}
file {
        path => "/home/syslog_final/Win_nonSec_2017*"
       type => ["file"]
        start_position => "beginning"
        }
}

filter
{  
	if [message] =~ "%NICWIN-4-System_11"
	{
                grok
                {

                match => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{GREEDYDATA:result}"]
                }
	mutate {
		add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
		}
	date {
		match => ["windate","YYYY-MMM-dd HH:mm:ss"]
		target => "EventDate"
	     }
	date_formatter {
		source => "EventDate"
		pattern => "YYYY-MM-dd HH:mm:ss"
		target => "eventdate"
		}
	csv {
		source => "result"
		separator => ","
	   }
	mutate {
				add_field => ["eventtype","%{column1}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column5}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column8}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
   
   }
else  if [message] =~ "%NICWIN-2-Application_103" and [message] =~ "SQLAgent"
         {
                grok
                {

                match => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{GREEDYDATA:result}"]
                }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
           }
mutate {
				add_field => ["eventtype","%{column1}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column5}"]
				#add_field => ["employeeid","%{}"]
				add_field => ["txncustomfield1","%{column6}"]
				add_field => ["eventdesc","%{column8}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				#ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
  	   
        }
else if [message] =~ "%NICWIN-2-Application_103" and [message] =~ "SYMCScan"
         {
                grok
                {

 match => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DATA},%{NUMBER:eventid},%{WORD},%{DATA},%{WORD},%{DATA:ser_nam},%{NUMBER},,%{DATA:desc} Date/time of event = %{DATA:symcscandate} %{TIME:symcscantime} %{GREEDYDATA:result}"]
                }
	  mutate {
		gsub => ["result"," = ","="]
	#	gsub => ["result","%{WORD}+%{WORD} ","%{WORD}%{WORD}"]
		}
	mutate
                {
                gsub => ["result", "/time of event","time"]
                gsub => ["result", "Event Severity Level", "EventSeverityLevel"]
                gsub => ["result", "Result ID","ResultID"]
                gsub => ["result", "File name","Filename"]
                gsub => ["result", "Client IP","ClientIP"]
                gsub => ["result", "Scan Duration (sec)","ScanDurationsec"]
                gsub => ["result", "Connect Duration (sec)","ConnectDurationsec"]
                gsub => ["result", "Symantec Protection Engine IP address","Symantec ProtectionEngineIPaddress "]
                gsub => ["result", "Symantec Protection Engine Port number","SymantecProtectionEnginePortnumber"]
                gsub => ["result", "Uptime (in seconds)","Uptimeinseconds"]
		}
	  kv {
		source => "result"
                value_split => "="
		
           }

mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{ser_nam}"]
				add_field => ["eventdate","%{symcscandate} %{symcscantime}"]
				add_field => ["txncustomfield1","%{EventSeverityLevel}"]
				add_field => ["eventdesc","%{desc}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				add_field => ["ipaddress","%{ClientIP}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				#ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				#ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
		   
        }
else if [message] =~ "%NICWIN-3-Application_1001_MsiInstaller:"
         {
                grok
                {

                match => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{WORD:obj_fol},%{DATA:txn5},%{WORD:obj_typ},%{DATA:ser_nam},%{NUMBER:txn1},,%{GREEDYDATA:result}"]
                }
	   mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }

          csv {
                source => "result"
                separator => ","
           }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{ser_nam}"]
				#add_field => ["employeeid","%{}"]
				add_field => ["txncustomfield1","%{column2}"]
				add_field => ["eventdesc","%{column1}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{txn5}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				#ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }   
        }
        
else if [message] =~ "%NICWIN-4-Application_1001_Windows Error Reporting:"
         {
                grok
                {

                match => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{DATA:obj_fol},,%{WORD:obj_typ},%{DATA:ser_nam},%{NUMBER:txn1},,%{DATA:txn7} , %{GREEDYDATA:result}"]
                }
	mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
	date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
	mutate {
		gsub => ["result",": ",":"]
		}
          kv {
                source => "result"
                #separator => ": "
                trimkey => "\s+/"
		value_split => ":"
		#field_split => " "
           }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{ser_nam}"]
				#add_field => ["employeeid","%{}"]
				add_field => ["txncustomfield1","%{txn7}"]
				add_field => ["eventdesc","%{Name}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{here}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{P5}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				#ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
				
        }
else if [message] =~ "%NICWIN" and [message] =~"Security_1102" and [message] !~ "AD FS Auditing"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{DATA:d},,%{DATA:e},%{DATA:f},%{DATA:g},,%{DATA:eventdesc}. Subject:  %{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                gsub => ["result","Security ID: ","SecurityID:"]
                gsub => ["result","Account Name: ","AccountName:"]
                gsub => ["result","Domain Name: ","DomainName:"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        kv {
                source => "result"
                value_split => ":"
            }
         mutate {
                add_field => ["eventtype","%{eventid}"]
                add_field => ["objecttype","%{e}"]
                add_field => ["domainname","%{DomainName}"]
        add_field => ["employeeid","%{AccountName}"]
        add_field => ["txncustomfield2","%{g}"]
                 }
           ruby { code => "event['txncustomfield1'] = nil" }
           ruby { code => "event['txncustomfield4'] = nil" }
           ruby { code => "event['objectname'] = nil" }
           ruby { code => "event['txncustomfield5'] = nil" }
           ruby { code => "event['txncustomfield6'] = nil" }
           ruby { code => "event['txncustomfield7'] = nil" }
           ruby { code => "event['ipaddress'] = nil" }
           ruby { code => "event['txncustomfield8'] = nil" }
           ruby { code => "event['txncustomfield10'] = nil" }
           ruby { code => "event['txncustomfield9'] = nil" }
        }
else if [message] =~ "%NICWIN-3-Application_324_PFM:"
{
	grok {
		match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
	    }
	mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
	csv {
		source => "result"
		separator => ","
	    }

	mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				add_field => ["txncustomfield1","%{column8}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				#ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }	
		
	}
else if [message] =~ "%NICWIN-3-System_101_Application Management Group Policy:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }

mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }			
        }

else if [message] =~ "%NICWIN-4-Application_300_ESENT:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        add_field => ["txncustomfield1","%{column5}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   #ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }
		
}
else if [message] =~ "%NICWIN-3-System_1004_IPMIDRV:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        add_field => ["txncustomfield1","%{column5}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   #ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }

else if [message] =~ "%NICWIN-3-System_40960_LsaSrv:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
	mutate {
		gsub => ["result","\"",""]
		}
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }

        }
#else if [message] =~ "%NICWIN" and [message] =~ "CertificateServicesClient-CertEnroll:" #65,64
else if [message] =~ "%NICWIN" and [message] =~ "CertificateServicesClient-" #65,64
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }

		
else if [message] =~ "%NICWIN" and [message] =~ "Microsoft-Windows-Directory-Services-SAM:" #12294
{
        grok {
     match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN-3-System_1014_Microsoft-Windows-DNS-Client:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            } 
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	 mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        add_field => ["txncustomfield3","%{column2}"]
        add_field => ["txncustomfield2","%{column5}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }	   
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   #ruby { code => "event['txncustomfield3'] = nil" }
	   #ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN--_111_Microsoft-Windows-EventForwarder:" 
{
        grok {
                match  => ["message","%{DATA:a}: ,rn= cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            } 
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
		add_field => ["eventtype","%{eventid}"]
		#add_field => ["objecttype","%{}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{}"]
        add_field => ["eventdesc","%{column1}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }  
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN-3-System_1112_Microsoft-Windows-GroupPolicy:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            } 
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	 mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        add_field => ["txncustomfield1","%{column8}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }	   
	   ruby { code => "event['employeeid'] = nil" }
	   #ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN" and [message] =~ "Microsoft-Windows-User Profiles Service:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	 mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{column2}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN-4-System_5186_Microsoft-Windows-WAS:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }
else if [message] =~ "%NICWIN-4-System_10120_Microsoft-Windows-WinRM:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }

        }

else if [message] =~ "%NICWIN-4-Application_2095_MSExchange ADAccess:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }

else if [message] =~ "%NICWIN" and [message] =~ "System_6013_EventLog:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN" and [message] =~ "NETLOGON:" #5722, 5723, 5805, 5807
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }

else if [message] =~ "%NICWIN-2-System_1211_PSM PwdFilter:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	 mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{column5}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN-2-Application_108_Report Server"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        add_field => ["txncustomfield1","%{column5}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   #ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
else if [message] =~ "%NICWIN-4-Application_1704_SceCli:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }

        }
		
else if [message] =~ "%NICWIN" and [message] =~ "Microsoft-Windows-Security-Auditing:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
        }
else if [message] =~ "%NICWIN" and [message] =~ "Microsoft-Windows-Security-SPP:" #12288, 16384
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
	 	mutate {
		add_field => ["eventtype","%{eventid}"]
		add_field => ["objecttype","%{b}"]
		add_field => ["domainname","%{column4}"]
        #add_field => ["employeeid","%{}"]
        #add_field => ["txncustomfield1","%{}"]
        add_field => ["eventdesc","%{column7}"]
		#add_field => ["txncustomfield4","%{}"]
		#add_field => ["objectname","%{}"]
		#add_field => ["txncustomfield5","%{}"]
        #add_field => ["txncustomfield6","%{}"]
        #add_field => ["txncustomfield7","%{}"]
        #add_field => ["ipaddress","%{}"]
		#add_field => ["txncustomfield8","%{}"]
		#add_field => ["txncustomfield10","%{}"]
		#add_field => ["txncustomfield9","%{}"]
        #add_field => ["txncustomfield3","%{}"]
        #add_field => ["txncustomfield2","%{}"]
		 }
	   #ruby { code => "event['objecttype'] = nil" }
       #ruby { code => "event['domainname'] = nil" }
	   ruby { code => "event['employeeid'] = nil" }
	   ruby { code => "event['txncustomfield1'] = nil" }
	   #ruby { code => "event['eventdesc'] = nil" }
	   ruby { code => "event['txncustomfield4'] = nil" }
	   ruby { code => "event['objectname'] = nil" }
	   ruby { code => "event['txncustomfield5'] = nil" }
	   ruby { code => "event['txncustomfield6'] = nil" }
	   ruby { code => "event['txncustomfield7'] = nil" }
	   ruby { code => "event['ipaddress'] = nil" }
	   ruby { code => "event['txncustomfield8'] = nil" }
	   ruby { code => "event['txncustomfield10'] = nil" }
	   ruby { code => "event['txncustomfield9'] = nil" }
	   ruby { code => "event['txncustomfield3'] = nil" }
	   ruby { code => "event['txncustomfield2'] = nil" }

        }
		
else if [message] =~ "%NICWIN-4" and [message] =~ "Server Administrator:" #2242, 2243, 2266
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				add_field => ["employeeid","%{column1}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				#ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }
		
else if [message] =~ "%NICWIN-4-System_7040_Service Control Manager:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid=%{NUMBER} eid=%{NUMBER},%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }
		
else if [message] =~ "%NICWIN-2-Application_12289_VSS:"
{
        grok {
                match  => ["message","%{DATA:a}: %{WORD:b},rn=%{NUMBER:c} cid= eid=,%{DAY:winday} %{MONTH:winmonth} %{MONTHDAY:winmonthday} %{TIME:winsys_ts} %{YEAR:winyear},%{NUMBER:eventid},%{GREEDYDATA:result}"]
            }
        mutate {
                add_field => ["windate","%{winyear}-%{winmonth}-%{winmonthday} %{winsys_ts}"]
                }
        date {
                match => ["windate","YYYY-MMM-dd HH:mm:ss"]
                target => "EventDate"
             }
        date_formatter {
                source => "EventDate"
                pattern => "YYYY-MM-dd HH:mm:ss"
                target => "eventdate"
                }
        csv {
                source => "result"
                separator => ","
            }
mutate {
				add_field => ["eventtype","%{eventid}"]
				add_field => ["objecttype","%{b}"]
				add_field => ["domainname","%{column4}"]
				#add_field => ["employeeid","%{}"]
				#add_field => ["txncustomfield1","%{}"]
				add_field => ["eventdesc","%{column7}"]
				#add_field => ["txncustomfield4","%{}"]
				#add_field => ["objectname","%{}"]
				#add_field => ["txncustomfield5","%{}"]
				#add_field => ["txncustomfield6","%{}"]
				#add_field => ["txncustomfield7","%{}"]
				#add_field => ["ipaddress","%{}"]
				#add_field => ["txncustomfield8","%{}"]
				#add_field => ["txncustomfield10","%{}"]
				#add_field => ["txncustomfield9","%{}"]
				#add_field => ["txncustomfield3","%{}"]
				#add_field => ["txncustomfield2","%{}"]
			}
				#ruby { code => "event['objecttype'] = nil" }
				#ruby { code => "event['domainname'] = nil" }
				ruby { code => "event['employeeid'] = nil" }
				ruby { code => "event['txncustomfield1'] = nil" }
				#ruby { code => "event['eventdesc'] = nil" }
				ruby { code => "event['txncustomfield4'] = nil" }
				ruby { code => "event['objectname'] = nil" }
				ruby { code => "event['txncustomfield5'] = nil" }
				ruby { code => "event['txncustomfield6'] = nil" }
				ruby { code => "event['txncustomfield7'] = nil" }
				ruby { code => "event['ipaddress'] = nil" }
				ruby { code => "event['txncustomfield8'] = nil" }
				ruby { code => "event['txncustomfield10'] = nil" }
				ruby { code => "event['txncustomfield9'] = nil" }
				ruby { code => "event['txncustomfield3'] = nil" }
				ruby { code => "event['txncustomfield2'] = nil" }
        }

}
output	
	{
		if [message] =~ "%NICWIN" and [message] =~"Security_1102" and [message] !~ "AD FS Auditing"
		 {
			   
					   csv 
					   {
							   fields => ["eventdate","eventtype","txncustomfield1","domainname","eventdesc","employeeid","txncustomfield2","objecttype","objectname","txncustomfield3","ipaddress","txncustomfield4","txncustomfield5","txncustomfield6","txncustomfield7","txncustomfield8","txncustomfield9","txncustomfield10"]
							   path => "/opt/gra/activitylogmgr/logs/out/syslog/Win_nonsec_1102_%{+YYYY-MM-dd-HH}.csv"
					   }
				}	
	#	stdout{
	#		codec => rubydebug
	#	}
	#	if "_grokparsefailure" in [tags]
	#	{
	#	file {
	#		path => "/opt/failed_msg.log"
	#	 }
	#	}
	}
